WITH station_buffers AS (
SELECT
    osm_id,              
    name,                 
    ST_Transform(way, 4326) AS geometry,  -- Transforming station coordinates to EPSG:4326
    ST_Transform(ST_Buffer(way::geometry, 250), 4326) AS buffer_geom  -- Creating a 250m buffer around each station and transforming to EPSG:4326
FROM
    planet_osm_point     
WHERE
    railway = 'station' AND
    osm_id IN (
		1239733410,1291611923,1300628760,2412401899,1348076004,1348149623,
		1348193962,2413525746,3074774945,3074774945,3074774944,1363390558,
		1363420493,1345880152,3080372104,1273321595,1273164743,3074886742,
		3080372090,1345694391,1305717852,1305660372,1305607315,1300646901,
		1300717238,1305115032,1305029643,3080372097,3080372101,3074886740,
		1280652702,2171580321,3080372083,3080695734,3080372106,1270614835,
		3080695736,2993022444,6034007294,6034007293,6034006572,6034006571,
		3081154442,3081154411,1975565226,2868073398,2868073901,1946558958,
		3081154447,5137617912,3081154404,9831727481,3046153730,2456031551,
		2486323396,2486344596,2486323397,2486375605,2486375610,2349962689,
		2509270355,2510493283,2510469066,2486668293,2486660802,1354779312,
		1354654530,2496687343,1349145903,1349145879,1843809989,3081154407,
		355014243,416460884,270166064,1676112496,3081154414,300248218,
		359723652,3081154428,3081154429,1948006333,357390773,983858469,
		357390768,3081154344,983805184,3081154377,3081154458,3081154372,
		696524685,2797580802,2809386073,2893470286,3081154430,2793245894,
		2793870896,2793811935,2790344845,2775838578,2775838608,2774680775,
		2770485920,5148276768,3025234417,3022062409,3052044268,3053167580,
		3053167578,4890696636,3080728389,8951918011,8131633128,6034006570,
		11283897236,255670378,2462102646,354739910,2463259316,2460281903,
		2460272281,2472559165,2460241310,273490212,4126897996,2463259314,
		3103498752,3103498753,3095850718,254841932,254841922,3095367597,
		2051794005,1398733009,1398833212,1398789169,2074359564,3080372091,
		3080372102,1360408889,3074774940,9652711258,9652711259,2051540372,
		1793087592,3074774949,3074774949,2897444037,2897444037
    )
),
buildings AS (
    SELECT
        egid,
		geometry as geom
    FROM
        public.buildings
    WHERE
        canton = 'ZH'
)
SELECT
    s.osm_id as station_osm_id,
    s.name as station_name,
    ST_Transform(s.geometry, 4326) AS geometry, -- Transform back to EPSG:4326 for compatibility with typical GIS use
    b.egid
FROM
    buildings AS b
JOIN
    station_buffers AS s ON ST_Intersects(b.geom, s.buffer_geom::geometry);
